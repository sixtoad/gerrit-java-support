= Demo Document =
Jean-Marc MEESSEN <mail@address.com>

:numbered!:
[abstract]
== Abstract ==
//image:AsciiDoctorLogoBig.png[logo, 100, align="right"]

This is a demonstration document generated by the `asciidoctor-maven-archetype`. Beside showing some basic asccidoc features, it explains and demonstrates an asciidoc to PDF "build pipeline" based on Maven. It is provided as a standalone maven project but it can be easily integrated in an existing project.

It also shows the integration of UMLet and PlantUML based UML graphics into the document as well as some useful asciidoc formating samples.

:numbered:
== Building a PDF with Maven and asciidoctor ==

This section explains the basic steps for building a PDF document from a asciidoc source with Maven. A working installation and some basic knowledge of Maven is assumed.

To check whether Maven is correctly installed, type at the command prompt `mvn version`. It should work and should display various version information. If you want to use UMLet conversion, Maven should use a 1.7 JVM.

=== Quick Start ===
To build this document use the command:

----
mvn install
----

After downloading the necessary components from the Internet, the asciidoc source will be compiled to a PDF document and moved to the same directory as where the `pom.xml` and the `document.adoc` are located.

And voil√† !

=== Principles ===

This Maven project processes an asciidoc source located in the root directory of the project (where the pom.xml is located).

The documentation project is built following the sequence (as shown in <<overview>>:

. generate diagrams from the UMLet sources.
. move static pictures to the temporary asciidoc image directory.
. generate a docbook document based on the asciidoc source.
. produce the PDF document using the docbook customization layer.
. copy the produced PDF to the root of the project, where the source file is located.

[[overview]]
.Asciidoctor PDF Maven build overview
image::overview.png[overview, 400, align="right"]


=== Phases ===

The PDF generation sequence is mapped to the following Maven phases.

. *generate-resources:convert* : converts the UMLet graphics to JPEGs.
. *generate-resources:copy-resources* : copy the static graphic resources to the target media directory.
. *generate-resources:process-asciidoc* : converts the asciidoc source to docbook with asciidoctor.
. *compile:generate-pdf* : renders the docbook document as a PDF
. *install:copy-resources* : copies the generated PDF document to the project's root

=== Directory structure ===

In the proposed documentation project structure, the asciidoc source documents are located `/src/doc/asciidoc` directory relative to the root of project (where the pom.xml is located). Static pictures are stored in the `/src/doc/media/images` directory and UMLet drawings in the `/src/doc/media/UML` directory. 

Find hereafter an overview of the directory structure:

* */pom.xmlfootnote:[Maven Project Object Model]* : the maven project definition file.
* */src/doc/asciidoc/document.adoc* : the main asciidoctor source file.
* */src/doc/docbkx* contains all the customization configuration files. Once the presentation of the document correctly defined, nothing should change there.
** *fo-stylesheets* contains the Docbook specific customization (`docbook.xsl`) and the title page definition (`demo_titlepages.xsl`). The later configuration is generated with the `.xml` template. Check the Docbook documentation for more details on how to customize these files.
** *fop-config*  contains the FOP specific configuration file (`fop.xconf`). It is mainly used for font substitutions.
** *images* contains images used for the presentation layer like logos for "book" title page or headers, draft watermark picture or admonestation graphics.
* */src/doc/media* contains the images or drawing to be included in the text.
** *images* is where static images are stored.
** *UML* is where the UMLet sources are locates. These sources are compiled to usable images by the UMLet Maven plugin.
* */target* contains all the generated files and artifacts.
** *docbook* is where asciidoctor writes its docbook output.
** *media* is where all the needed images (static or generated) are temporarily stored.
** *pdf* is where the pdf generation plug-in `docbkx` stores its outputs: the PDF and the FO files. Note that when using the `install` Maven goal, the PDF file is copied back to the root of the project.

[[directories]]
.Asciidoctor PDF Maven directories overview
image::directories.png["directories", 320, align="right"]

<<<

=== Integrating UML graphics and other pictures ===

Integrating static pictures in a document is straight forward as can be seen below. 

[[samplePicture]]
.A sample picturefootnote:[Sample picture from site http://www.zend.com/fr/community/zend-developer-pulse-summer-2012]
image::Zend-Developer-Pulse-survey-Q2-2012-Graph-06.jpg[sample, 400, align="right"]

The previous pages of this document also show how to integrate UML images generated on the fly. The UML graphics are edited with the UMLetfootnote:[Open source software, under GNU GPL license] tool. For more details, check out the UMLet site (http://www.umlet.com).

The Maven integration of UMLet is done with the umlet-maven-plugin. For more details, check out the plug-in site (http://ykryshchuk.github.io/umlet-maven-plugin).

Note that I observed some weird generation artifacts that are still under investigation (arrows or frames appearing offset).

It is also possible to integrate 'plantUMLfootnote:[http://plantuml.sourceforge.net/]' drawing generated with the plantuml-maven-plugin (https://github.com/jeluard/maven-plantuml-plugin). See the generated graphic below.

[[plantUML]]
.A sample PlantUML graphic
image::demo.png[plantUML,320]


== Advanced topics ==

Asciidoctor and Docbook are very rich document description languages. Docbook has a fairly steep learning curve. I tried to illustrate as many features by commenting the `pom.xml` and the different configuration files. 

[NOTE]
====
This demo document is not really the place for a detailed explanation of all the configuration options.
====

I strongly recommend the following readings:

* *DocBook XSL: The Complete Guide* (http://www.sagehill.net/docbookxsl). It describes in details all the DocBook customizations possibilities.
* *docbkx Maven plug-in documentation* (https://code.google.com/p/docbkx-tools/ and http://docbkx-tools.sourceforge.net)

To list all the docbkx plug-in options configurable in the pom.xml (thus avoiding to have to tweak the customization layer), use the command :

----
mvn help:describe -Dcmd=docbkx:generate-pdf -Ddetail
----